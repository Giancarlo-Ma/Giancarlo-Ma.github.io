<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="baidu-site-verification" content="LXuJEpjaKP" />
<meta name="google-site-verification" content="Ua5o3QmWpq8fShnQBye7AB9hZQSy-k49fUJrl5BPWh0" />
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="TreesQ1: Replace LeafDefine replace_leaf, which takes a tree t, a value old, and a value new. replace_leaf returns a new tree that’s the same as t except that every leaf value equal to old has been re">
<meta property="og:type" content="article">
<meta property="og:title" content="cs61a-hw05">
<meta property="og:url" content="http://yoursite.com/2018/10/16/cs61a-hw05/index.html">
<meta property="og:site_name" content="Giancarlo&#39;s Blog">
<meta property="og:description" content="TreesQ1: Replace LeafDefine replace_leaf, which takes a tree t, a value old, and a value new. replace_leaf returns a new tree that’s the same as t except that every leaf value equal to old has been re">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-10-16T09:55:04.000Z">
<meta property="article:modified_time" content="2020-06-07T02:09:32.620Z">
<meta property="article:author" content="Guohang Ma">
<meta property="article:tag" content="python">
<meta property="article:tag" content="SICP">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2018/10/16/cs61a-hw05/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>cs61a-hw05 | Giancarlo's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Giancarlo's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Code && Peaceful Life</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/16/cs61a-hw05/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Guohang Ma">
      <meta itemprop="description" content="📚⏰🎶🎸🏊🏽‍♂️🏃🏽‍🍦🍌🍓🌳🗽Love all things...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Giancarlo's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          cs61a-hw05
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-10-16 17:55:04" itemprop="dateCreated datePublished" datetime="2018-10-16T17:55:04+08:00">2018-10-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-06-07 10:09:32" itemprop="dateModified" datetime="2020-06-07T10:09:32+08:00">2020-06-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS61A/" itemprop="url" rel="index"><span itemprop="name">CS61A</span></a>
                </span>
            </span>

          
            <span id="/2018/10/16/cs61a-hw05/" class="post-meta-item leancloud_visitors" data-flag-title="cs61a-hw05" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Trees"><a href="#Trees" class="headerlink" title="Trees"></a>Trees</h1><h2 id="Q1-Replace-Leaf"><a href="#Q1-Replace-Leaf" class="headerlink" title="Q1: Replace Leaf"></a>Q1: Replace Leaf</h2><p>Define <code>replace_leaf</code>, which takes a tree <code>t</code>, a value <code>old</code>, and a value <code>new</code>. <code>replace_leaf</code> returns a new tree that’s the same as <code>t</code> except that every leaf value equal to <code>old</code> has been replaced with <code>new</code>.</p>
<a id="more"></a>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">replace_leaf</span><span class="params">(t, old, new)</span>:</span></span><br><span class="line">   <span class="string">"""Returns a new tree where every leaf value equal to old has</span></span><br><span class="line"><span class="string">   been replaced with new.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; yggdrasil = tree('odin',</span></span><br><span class="line"><span class="string">   ...                  [tree('balder',</span></span><br><span class="line"><span class="string">   ...                        [tree('thor'),</span></span><br><span class="line"><span class="string">   ...                         tree('loki')]),</span></span><br><span class="line"><span class="string">   ...                   tree('frigg',</span></span><br><span class="line"><span class="string">   ...                        [tree('thor')]),</span></span><br><span class="line"><span class="string">   ...                   tree('thor',</span></span><br><span class="line"><span class="string">   ...                        [tree('sif'),</span></span><br><span class="line"><span class="string">   ...                         tree('thor')]),</span></span><br><span class="line"><span class="string">   ...                   tree('thor')])</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; laerad = copy_tree(yggdrasil) # copy yggdrasil for testing purposes</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; print_tree(replace_leaf(yggdrasil, 'thor', 'freya'))</span></span><br><span class="line"><span class="string">   odin</span></span><br><span class="line"><span class="string">     balder</span></span><br><span class="line"><span class="string">       freya</span></span><br><span class="line"><span class="string">       loki</span></span><br><span class="line"><span class="string">     frigg</span></span><br><span class="line"><span class="string">       freya</span></span><br><span class="line"><span class="string">     thor</span></span><br><span class="line"><span class="string">       sif</span></span><br><span class="line"><span class="string">       freya</span></span><br><span class="line"><span class="string">     freya</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; laerad == yggdrasil # Make sure original tree is unmodified</span></span><br><span class="line"><span class="string">   True</span></span><br><span class="line"><span class="string">   """</span></span><br><span class="line">   <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">   <span class="keyword">if</span> is_leaf(t) <span class="keyword">and</span> label(t) == old:</span><br><span class="line">       <span class="keyword">return</span> tree(new)</span><br><span class="line">   <span class="keyword">return</span> tree(label(t), [replace_leaf(b, old, new) <span class="keyword">for</span> b <span class="keyword">in</span> branches(t)])</span><br></pre></td></tr></table></figure>

<h1 id="Mobiles"><a href="#Mobiles" class="headerlink" title="Mobiles"></a>Mobiles</h1><p><strong>Acknowledgements</strong>. This mobile example is based on a classic problem from Structure and Interpretation of Computer Programs, Section 2.2.2.</p>
<p>A mobile is a type of hanging sculpture. A binary mobile consists of two sides. Each side is a rod of a certain length, from which hangs either a weight or another mobile.</p>
<p>We will represent a binary mobile using the data abstractions below.</p>
<ul>
<li>A <code>mobile</code> has a left <code>side</code> and a right <code>side</code>.</li>
<li>A <code>side</code> has a positive length and something hanging at the end, either a <code>mobile</code> or <code>weight</code>.</li>
<li>A <code>weight</code> has a positive size.<h2 id="Q2-Weights"><a href="#Q2-Weights" class="headerlink" title="Q2: Weights"></a>Q2: Weights</h2>Implement the <code>weight</code> data abstraction by completing the <code>weight</code> constructor and the <code>size</code> selector so that a weight is represented using a two-element list where the first element is the string <code>&#39;weight&#39;</code>. The <code>total_weight</code> example is provided to demonstrate use of the mobile, side, and weight abstractions.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mobile</span><span class="params">(left, right)</span>:</span></span><br><span class="line">    <span class="string">"""Construct a mobile from a left side and a right side."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_side(left), <span class="string">"left must be a side"</span></span><br><span class="line">    <span class="keyword">assert</span> is_side(right), <span class="string">"right must be a side"</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'mobile'</span>, left, right]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_mobile</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Return whether m is a mobile."""</span></span><br><span class="line">    <span class="keyword">return</span> type(m) == list <span class="keyword">and</span> len(m) == <span class="number">3</span> <span class="keyword">and</span> m[<span class="number">0</span>] == <span class="string">'mobile'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">left</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Select the left side of a mobile."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_mobile(m), <span class="string">"must call left on a mobile"</span></span><br><span class="line">    <span class="keyword">return</span> m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">right</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Select the right side of a mobile."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_mobile(m), <span class="string">"must call right on a mobile"</span></span><br><span class="line">    <span class="keyword">return</span> m[<span class="number">2</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">side</span><span class="params">(length, mobile_or_weight)</span>:</span></span><br><span class="line">    <span class="string">"""Construct a side: a length of rod with a mobile or weight at the end."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_mobile(mobile_or_weight) <span class="keyword">or</span> is_weight(mobile_or_weight)</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'side'</span>, length, mobile_or_weight]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_side</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="string">"""Return whether s is a side."""</span></span><br><span class="line">    <span class="keyword">return</span> type(s) == list <span class="keyword">and</span> len(s) == <span class="number">3</span> <span class="keyword">and</span> s[<span class="number">0</span>] == <span class="string">'side'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">length</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="string">"""Select the length of a side."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_side(s), <span class="string">"must call length on a side"</span></span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">end</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="string">"""Select the mobile or weight hanging at the end of a side."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_side(s), <span class="string">"must call end on a side"</span></span><br><span class="line">    <span class="keyword">return</span> s[<span class="number">2</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">weight</span><span class="params">(size)</span>:</span></span><br><span class="line">    <span class="string">"""Construct a weight of some size."""</span></span><br><span class="line">    <span class="keyword">assert</span> size &gt; <span class="number">0</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'weight'</span>, size]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">size</span><span class="params">(w)</span>:</span></span><br><span class="line">    <span class="string">"""Select the size of a weight."""</span></span><br><span class="line">    <span class="keyword">assert</span> is_weight(w), <span class="string">'must call size on a weight'</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">return</span> w[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_weight</span><span class="params">(w)</span>:</span></span><br><span class="line">    <span class="string">"""Whether w is a weight."""</span></span><br><span class="line">    <span class="keyword">return</span> type(w) == list <span class="keyword">and</span> len(w) == <span class="number">2</span> <span class="keyword">and</span> w[<span class="number">0</span>] == <span class="string">'weight'</span></span><br></pre></td></tr></table></figure>

<h2 id="Q3-Balanced"><a href="#Q3-Balanced" class="headerlink" title="Q3: Balanced"></a>Q3: Balanced</h2><p>Implement the <code>balanced</code> function, which returns whether <code>m</code> is a balanced mobile. A mobile is balanced if two conditions are met:</p>
<ol>
<li>The torque(转矩) applied by its left side is equal to that applied by its right side. Torque of the left side is the length of the left rod multiplied by the total weight hanging from that rod. Likewise for the right.</li>
<li>Each of the mobiles hanging at the end of its sides is balanced.<br>Hint: You may find it helpful to assume that weights themselves are balanced.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">balanced</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Return whether m is balanced.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; t, u, v = examples()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; balanced(t)</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; balanced(v)</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w = mobile(side(3, t), side(2, u))</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; balanced(w)</span></span><br><span class="line"><span class="string">    False</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; balanced(mobile(side(1, v), side(1, w)))</span></span><br><span class="line"><span class="string">    False</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; balanced(mobile(side(1, w), side(1, v)))</span></span><br><span class="line"><span class="string">    False</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">if</span> is_weight(m):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        left_end, right_end = end(left(m)), end(right(m))</span><br><span class="line">        torque_left = length(left(m)) * total_weight(left_end)</span><br><span class="line">        torque_right = length(right(m)) * total_weight(right_end)</span><br><span class="line">        <span class="keyword">return</span> torque_left == torque_right <span class="keyword">and</span> balanced(left_end) <span class="keyword">and</span> balanced(right_end)</span><br></pre></td></tr></table></figure>

<p><span style="color:red">The balanced weights assumption is important, since we will be solving this recursively like many other tree problems (even though this is not explicitly a tree).</span></p>
<p><span style="color:red"><strong>Base case</strong>: if we are checking a weight, then we know that this is balanced. Why is this an appropriate base case? There are two possible approaches to this:</span></p>
<p><span style="color:red">1. Because we know that our data structures so far are trees, weights are the simplest possible tree since we have chosen to implement them as leaves.</span><br><span style="color:red">2. We also know that from an ADT standpoint, weights are the terminal item in a mobile. There can be no further mobile structures under this weight, so it makes sense to stop check here.</span><br><span style="color:red"><strong>Otherwise</strong>: note that it is important to do a recursive call to check if both sides are balanced. However, we also need to do the basic comparison of looking at the total weight of both sides as well as their length. For example if both sides are a weight, trivially, they will both be balanced. However, the torque must be equal in order for the entire mobile to balanced (i.e. it’s insufficient to just check if the sides are balanced).</span></p>
<h2 id="Q4-Totals"><a href="#Q4-Totals" class="headerlink" title="Q4: Totals"></a>Q4: Totals</h2><p>Implement <code>totals_tree</code>, which takes a <code>mobile</code> (or <code>weight</code>) and returns a <code>tree</code> whose root is its total weight and whose branches are trees for the ends of the sides.<br><span style="color:red">My solution</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">totals_tree</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Return a tree representing the mobile with its total weight at the root.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; t, u, v = examples()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(t))</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">      2</span></span><br><span class="line"><span class="string">      1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(u))</span></span><br><span class="line"><span class="string">    6</span></span><br><span class="line"><span class="string">      1</span></span><br><span class="line"><span class="string">      5</span></span><br><span class="line"><span class="string">        3</span></span><br><span class="line"><span class="string">        2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(v))</span></span><br><span class="line"><span class="string">    9</span></span><br><span class="line"><span class="string">      3</span></span><br><span class="line"><span class="string">        2</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">      6</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">        5</span></span><br><span class="line"><span class="string">          3</span></span><br><span class="line"><span class="string">          2</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">if</span> is_weight(m):</span><br><span class="line">        <span class="keyword">return</span> tree(total_weight(m))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> tree(total_weight(m), [totals_tree(end(left(m))), totals_tree(end(right(m)))])</span><br></pre></td></tr></table></figure>
<p><span style="color:red">The PDF solution, which I think is so intellectual!!</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">totals_tree</span><span class="params">(m)</span>:</span></span><br><span class="line">    <span class="string">"""Return a tree representing the mobile with its total weight at the root.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; t, u, v = examples()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(t))</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">      2</span></span><br><span class="line"><span class="string">      1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(u))</span></span><br><span class="line"><span class="string">    6</span></span><br><span class="line"><span class="string">      1</span></span><br><span class="line"><span class="string">      5</span></span><br><span class="line"><span class="string">        3</span></span><br><span class="line"><span class="string">        2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(totals_tree(v))</span></span><br><span class="line"><span class="string">    9</span></span><br><span class="line"><span class="string">      3</span></span><br><span class="line"><span class="string">        2</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">      6</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">        5</span></span><br><span class="line"><span class="string">          3</span></span><br><span class="line"><span class="string">          2</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> is_weight(m):</span><br><span class="line">        <span class="keyword">return</span> tree(size(m))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        branches = [totals_tree(end(f(m))) <span class="keyword">for</span> f <span class="keyword">in</span> [left, right]]</span><br><span class="line">        <span class="keyword">return</span> tree(sum([label(b) <span class="keyword">for</span> b <span class="keyword">in</span> branches]), branches)</span><br></pre></td></tr></table></figure>
<h1 id="Mutable-functions"><a href="#Mutable-functions" class="headerlink" title="Mutable functions"></a>Mutable functions</h1><h2 id="Q5-Counter"><a href="#Q5-Counter" class="headerlink" title="Q5: Counter"></a>Q5: Counter</h2><p>Define a function <code>make_counter</code> that returns a <code>counter</code> function, which takes a string and returns the number of times that the function has been called on that string.<br><span style="color:red">My solution(a little stupid, not general)</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_counter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Return a counter function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2 = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b') + c2('b')</span></span><br><span class="line"><span class="string">    5</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    m = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> m.get(s, <span class="number">0</span>) == <span class="number">0</span>:</span><br><span class="line">            m[s] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            m[s] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> m[s]</span><br><span class="line">    <span class="keyword">return</span> f</span><br></pre></td></tr></table></figure>
<p><span style="color:red">The PDF solution(smart and beautiful, general)</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_counter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Return a counter function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2 = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b') + c2('b')</span></span><br><span class="line"><span class="string">    5</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    m = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">(key)</span>:</span></span><br><span class="line">        m[key] = m.get(key, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> m[key]</span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_counter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Return a counter function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('a')</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2 = make_counter()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c2('b')</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; c('b') + c2('b')</span></span><br><span class="line"><span class="string">    5</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    m = &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">(s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">in</span> m:</span><br><span class="line">            m[s] = <span class="number">0</span></span><br><span class="line">        m[s] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> m[s]</span><br><span class="line">    <span class="keyword">return</span> counter</span><br></pre></td></tr></table></figure>

<h2 id="Q6-Next-Fibonacci"><a href="#Q6-Next-Fibonacci" class="headerlink" title="Q6: Next Fibonacci"></a>Q6: Next Fibonacci</h2><p>Write a function <code>make_fib</code> that returns a function that returns the next Fibonacci number each time it is called. (The Fibonacci sequence begins with 0 and then 1, after which each element is the sum of the preceding two.) Use a <code>nonlocal</code> statement!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_fib</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Returns a function that returns the next Fibonacci number</span></span><br><span class="line"><span class="string">    every time it is called.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib = make_fib()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib()</span></span><br><span class="line"><span class="string">    0</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib()</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib()</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib()</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib()</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib2 = make_fib()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fib() + sum([fib2() for _ in range(5)])</span></span><br><span class="line"><span class="string">    12</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    current, next = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> current, next</span><br><span class="line">        result = current</span><br><span class="line">        current, next = next, current + next</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">return</span> fib</span><br></pre></td></tr></table></figure>
<h2 id="Q7-Password-Protected-Account"><a href="#Q7-Password-Protected-Account" class="headerlink" title="Q7: Password Protected Account"></a>Q7: Password Protected Account</h2><p>In lecture, we saw how to use functions to create mutable objects. Here, for example, is the function <code>make_withdraw</code> which produces a function that can withdraw money from an account:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_withdraw</span><span class="params">(balance)</span>:</span></span><br><span class="line">    <span class="string">"""Return a withdraw function with BALANCE as its starting balance.</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; withdraw = make_withdraw(1000)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; withdraw(100)</span></span><br><span class="line"><span class="string">    900</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; withdraw(100)</span></span><br><span class="line"><span class="string">    800</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; withdraw(900)</span></span><br><span class="line"><span class="string">    'Insufficient funds'</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">withdraw</span><span class="params">(amount)</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> balance</span><br><span class="line">        <span class="keyword">if</span> amount &gt; balance:</span><br><span class="line">           <span class="keyword">return</span> <span class="string">'Insufficient funds'</span></span><br><span class="line">        balance = balance - amount</span><br><span class="line">        <span class="keyword">return</span> balance</span><br><span class="line">    <span class="keyword">return</span> withdraw</span><br></pre></td></tr></table></figure>
<p>Write a version of the <code>make_withdraw</code> function that returns password-protected withdraw functions. That is, <code>make_withdraw</code> should take a password argument (a string) in addition to an initial balance. The returned function should take two arguments: an amount to withdraw and a password.</p>
<p>A password-protected <code>withdraw</code> function should only process withdrawals that include a password that matches the original. Upon receiving an incorrect password, the function should:</p>
<ol>
<li><p>Store that incorrect password in a list, and</p>
</li>
<li><p>Return the string ‘Incorrect password’.<br>If a withdraw function has been called three times with incorrect passwords <code>p1</code>, <code>p2</code>, and <code>p3</code>, then it is locked. All subsequent calls to the function should return:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Your account is locked. Attempts: [&lt;p1&gt;, &lt;p2&gt;, &lt;p3&gt;]&quot;</span><br></pre></td></tr></table></figure>
<p>The incorrect passwords may be the same or different:<br><span style="color:red">My solution<span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_withdraw</span><span class="params">(balance, password)</span>:</span></span><br><span class="line">   <span class="string">"""Return a password-protected withdraw function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w = make_withdraw(100, 'hax0r')</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(25, 'hax0r')</span></span><br><span class="line"><span class="string">   75</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; error = w(90, 'hax0r')</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; error</span></span><br><span class="line"><span class="string">   'Insufficient funds'</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; error = w(25, 'hwat')</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; error</span></span><br><span class="line"><span class="string">   'Incorrect password'</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; new_bal = w(25, 'hax0r')</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; new_bal</span></span><br><span class="line"><span class="string">   50</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(75, 'a')</span></span><br><span class="line"><span class="string">   'Incorrect password'</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(10, 'hax0r')</span></span><br><span class="line"><span class="string">   40</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(20, 'n00b')</span></span><br><span class="line"><span class="string">   'Incorrect password'</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(10, 'hax0r')</span></span><br><span class="line"><span class="string">   "Your account is locked. Attempts: ['hwat', 'a', 'n00b']"</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; w(10, 'l33t')</span></span><br><span class="line"><span class="string">   "Your account is locked. Attempts: ['hwat', 'a', 'n00b']"</span></span><br><span class="line"><span class="string">   &gt;&gt;&gt; type(w(10, 'l33t')) == str</span></span><br><span class="line"><span class="string">   True</span></span><br><span class="line"><span class="string">   """</span></span><br><span class="line">   <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">   l = []</span><br><span class="line">   num = <span class="number">0</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">withdraw</span><span class="params">(amount, p)</span>:</span></span><br><span class="line">       <span class="keyword">nonlocal</span> num, balance</span><br><span class="line">       <span class="keyword">if</span> num == <span class="number">3</span>:</span><br><span class="line">           <span class="keyword">return</span> <span class="string">'Your account is locked. Attempts: '</span> + str(l)</span><br><span class="line">       <span class="keyword">if</span> p != password:</span><br><span class="line">           l.append(p)</span><br><span class="line">           num += <span class="number">1</span></span><br><span class="line">           <span class="keyword">return</span> <span class="string">'Incorrect password'</span></span><br><span class="line">       <span class="keyword">if</span> amount &gt; balance:</span><br><span class="line">           <span class="keyword">return</span> <span class="string">'Insufficient funds'</span></span><br><span class="line">       balance -= amount</span><br><span class="line">       <span class="keyword">return</span> balance</span><br><span class="line">   <span class="keyword">return</span> withdraw</span><br></pre></td></tr></table></figure>
<p><span style="color:red">The PDF solution, which have not a num variable.</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_withdraw</span><span class="params">(balance, password)</span>:</span></span><br><span class="line">    <span class="string">"""Return a password-protected withdraw function.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w = make_withdraw(100, 'hax0r')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(25, 'hax0r')</span></span><br><span class="line"><span class="string">    75</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; error = w(90, 'hax0r')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; error</span></span><br><span class="line"><span class="string">    'Insufficient funds'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; error = w(25, 'hwat')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; error</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; new_bal = w(25, 'hax0r')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; new_bal</span></span><br><span class="line"><span class="string">    50</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(75, 'a')</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(10, 'hax0r')</span></span><br><span class="line"><span class="string">    40</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(20, 'n00b')</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(10, 'hax0r')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['hwat', 'a', 'n00b']"</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(10, 'l33t')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['hwat', 'a', 'n00b']"</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; type(w(10, 'l33t')) == str</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    attempts = []</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">withdraw</span><span class="params">(amount, password_attempt)</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> balance</span><br><span class="line">        <span class="keyword">if</span> len(attempts) == <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'Your account is locked. Attempts: '</span> + str(attempts)</span><br><span class="line">        <span class="keyword">if</span> password_attempt != password:</span><br><span class="line">            attempts.append(password_attempt)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'Incorrect password'</span></span><br><span class="line">        <span class="keyword">if</span> amount &gt; balance:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'Insufficient funds'</span></span><br><span class="line">        balance = balance - amount</span><br><span class="line">        <span class="keyword">return</span> balance</span><br><span class="line">    <span class="keyword">return</span> withdraw</span><br></pre></td></tr></table></figure>
<h2 id="Q8-Joint-Account"><a href="#Q8-Joint-Account" class="headerlink" title="Q8: Joint Account"></a>Q8: Joint Account</h2><p>Suppose that our banking system requires the ability to make joint accounts. Define a function <code>make_joint</code> that takes three arguments.</p>
</li>
<li><p>A password-protected <code>withdraw</code> function,</p>
</li>
<li><p>The password with which that <code>withdraw</code> function was defined, and</p>
</li>
<li><p>A new password that can also access the original account.<br>The <code>make_joint</code> function returns a <code>withdraw</code> function that provides additional access to the original account using either the new or old password. Both functions draw from the same balance. Incorrect passwords provided to either function will be stored and cause the functions to be locked after three wrong attempts.</p>
</li>
</ol>
<p>Hint: The solution is short (less than 10 lines) and contains no string literals! The key is to call <code>withdraw</code> with the right password and amount, then interpret the result. You may assume that all failed attempts to withdraw will return some string (for incorrect passwords, locked accounts, or insufficient funds), while successful withdrawals will return a number.</p>
<p>Use <code>type(value) == str</code> to test if some <code>value</code> is a string:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_joint</span><span class="params">(withdraw, old_password, new_password)</span>:</span></span><br><span class="line">    <span class="string">"""Return a password-protected withdraw function that has joint access to</span></span><br><span class="line"><span class="string">    the balance of withdraw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w = make_withdraw(100, 'hax0r')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(25, 'hax0r')</span></span><br><span class="line"><span class="string">    75</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; make_joint(w, 'my', 'secret')</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j = make_joint(w, 'hax0r', 'secret')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(25, 'secret')</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j(25, 'secret')</span></span><br><span class="line"><span class="string">    50</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j(25, 'hax0r')</span></span><br><span class="line"><span class="string">    25</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j(100, 'secret')</span></span><br><span class="line"><span class="string">    'Insufficient funds'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2 = make_joint(j, 'secret', 'code')</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2(5, 'code')</span></span><br><span class="line"><span class="string">    20</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2(5, 'secret')</span></span><br><span class="line"><span class="string">    15</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2(5, 'hax0r')</span></span><br><span class="line"><span class="string">    10</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2(25, 'password')</span></span><br><span class="line"><span class="string">    'Incorrect password'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j2(5, 'secret')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['my', 'secret', 'password']"</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; j(5, 'secret')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['my', 'secret', 'password']"</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; w(5, 'hax0r')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['my', 'secret', 'password']"</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; make_joint(w, 'hax0r', 'hello')</span></span><br><span class="line"><span class="string">    "Your account is locked. Attempts: ['my', 'secret', 'password']"</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    error = withdraw(<span class="number">0</span>, old_password)</span><br><span class="line">    <span class="keyword">if</span> type(error) == str:</span><br><span class="line">         <span class="keyword">return</span> error</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">joint</span><span class="params">(amount, attempt)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> attempt == new_password:</span><br><span class="line">            <span class="keyword">return</span> withdraw(amount, old_password)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> withdraw(amount, attempt)</span><br><span class="line">    <span class="keyword">return</span> joint</span><br></pre></td></tr></table></figure>
<h1 id="Generators"><a href="#Generators" class="headerlink" title="Generators"></a>Generators</h1><h2 id="Q9-Generate-Paths"><a href="#Q9-Generate-Paths" class="headerlink" title="Q9: Generate Paths"></a>Q9: Generate Paths</h2><p>Define a generator function <code>generate_paths</code> which takes in a tree <code>t</code>, a value <code>x</code>, and yields each path from the root of <code>t</code> to a node that has label <code>x</code>. Each path should be represented as a list of the labels along that path in the tree. You may yield the paths in any order.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_paths</span><span class="params">(t, x)</span>:</span></span><br><span class="line">    <span class="string">"""Yields all possible paths from the root of t to a node with the label x as a list.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; t1 = tree(1, [tree(2, [tree(3), tree(4, [tree(6)]), tree(5)]), tree(5)])</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(t1)</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">      2</span></span><br><span class="line"><span class="string">        3</span></span><br><span class="line"><span class="string">        4</span></span><br><span class="line"><span class="string">          6</span></span><br><span class="line"><span class="string">        5</span></span><br><span class="line"><span class="string">      5</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; next(generate_paths(t1, 6))</span></span><br><span class="line"><span class="string">    [1, 2, 4, 6]</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; path_to_5 = generate_paths(t1, 5)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; sorted(list(path_to_5))</span></span><br><span class="line"><span class="string">    [[1, 2, 5], [1, 5]]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; t2 = tree(0, [tree(2, [t1])])</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; print_tree(t2)</span></span><br><span class="line"><span class="string">    0</span></span><br><span class="line"><span class="string">      2</span></span><br><span class="line"><span class="string">        1</span></span><br><span class="line"><span class="string">          2</span></span><br><span class="line"><span class="string">            3</span></span><br><span class="line"><span class="string">            4</span></span><br><span class="line"><span class="string">              6</span></span><br><span class="line"><span class="string">            5</span></span><br><span class="line"><span class="string">          5</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; path_to_2 = generate_paths(t2, 2)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; sorted(list(path_to_2))</span></span><br><span class="line"><span class="string">    [[0, 2], [0, 2, 1, 2]]</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">if</span> label(t) == x:</span><br><span class="line">        <span class="keyword">yield</span> [x]</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> branches(t):</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> generate_paths(b, x):</span><br><span class="line">            <span class="keyword">yield</span> [label(t)] + path</span><br></pre></td></tr></table></figure>
<p><span style="color:red">If our current label is equal to x, we’ve found a path from the root to a node containing x containing only our current label, so we should yield that. From there, we’ll see if there are any paths starting from one of our branches that ends at a node containing x. If we find these “partial paths” we can simply add our current label to the beinning of a path to obtain a path starting from the root.</span></p>
<p><span style="color:red">In order to do this, we’ll create a generator for each of the branches which yields these “partial paths”. By calling generate_paths on each of the branches, we’ll create exactly this generator! Then, since a generator is also an iterable, we can iterate over the paths in this generator and yield the result of concatenating it with our current label.</span></p>
<h1 id="Interval"><a href="#Interval" class="headerlink" title="Interval"></a>Interval</h1><p><strong>Acknowledgements</strong>. This interval arithmetic example is based on a classic problem from Structure and Interpretation of Computer Programs, Section 2.1.4.</p>
<p><strong>Introduction</strong>. Alyssa P. Hacker is designing a system to help people solve engineering problems. One feature she wants to provide in her system is the ability to manipulate inexact quantities (such as measured parameters of physical devices) with known precision, so that when computations are done with such approximate quantities the results will be numbers of known precision.</p>
<p>Alyssa’s idea is to implement interval arithmetic as a set of arithmetic operations for combining “intervals” (objects that represent the range of possible values of an inexact quantity). The result of adding, subracting, multiplying, or dividing two intervals is itself an interval, representing the range of the result.</p>
<p>Alyssa postulates the existence of an abstract object called an “interval” that has two endpoints: a lower bound and an upper bound. She also presumes that, given the endpoints of an interval, she can construct the interval using the data constructor interval. Using the constructor and selectors, she defines the following operations:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_interval</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">"""Return a string representation of interval x."""</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&#123;0&#125; to &#123;1&#125;'</span>.format(lower_bound(x), upper_bound(x))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_interval</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""Return an interval that contains the sum of any value in interval x and</span></span><br><span class="line"><span class="string">    any value in interval y."""</span></span><br><span class="line">    lower = lower_bound(x) + lower_bound(y)</span><br><span class="line">    upper = upper_bound(x) + upper_bound(y)</span><br><span class="line">    <span class="keyword">return</span> interval(lower, upper)</span><br></pre></td></tr></table></figure>
<h2 id="Q10-Interval-Abstraction"><a href="#Q10-Interval-Abstraction" class="headerlink" title="Q10: Interval Abstraction"></a>Q10: Interval Abstraction</h2><p>Alyssa’s program is incomplete because she has not specified the implementation of the interval abstraction. She has implemented the constructor for you; fill in the implementation of the selectors.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">interval</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="string">"""Construct an interval from a to b."""</span></span><br><span class="line">    <span class="keyword">assert</span> a &lt;= b, <span class="string">'Lower bound cannot be greater than upper bound'</span></span><br><span class="line">    <span class="keyword">return</span> [a, b]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lower_bound</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">"""Return the lower bound of interval x."""</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upper_bound</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">"""Return the upper bound of interval x."""</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>Louis Reasoner has also provided an implementation of interval multiplication. Beware: there are some data abstraction violations, so help him fix his code before someone sets it on fire.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul_interval</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""Return the interval that contains the product of any value in x and any</span></span><br><span class="line"><span class="string">    value in y."""</span></span><br><span class="line">    p1 = x[<span class="number">0</span>] * y[<span class="number">0</span>]</span><br><span class="line">    p2 = x[<span class="number">0</span>] * y[<span class="number">1</span>]</span><br><span class="line">    p3 = x[<span class="number">1</span>] * y[<span class="number">0</span>]</span><br><span class="line">    p4 = x[<span class="number">1</span>] * y[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> [min(p1, p2, p3, p4), max(p1, p2, p3, p4)]</span><br></pre></td></tr></table></figure>
<p>The modification</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mul_interval</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""Return the interval that contains the product of any value in x and any value in y."""</span></span><br><span class="line">    p1 = lower_bound(x) * lower_bound(y)</span><br><span class="line">    p2 = lower_bound(x) * upper_bound(y)</span><br><span class="line">    p3 = higher_bound(x) * lower_bound(y)</span><br><span class="line">    p4 = higher_bound(x) * upper_bound(y)</span><br><span class="line">    <span class="keyword">return</span> [min(p1, p2, p3, p4), max(p1, p2, p3, p4)]</span><br></pre></td></tr></table></figure>
<h2 id="Q11-Sub-Interval"><a href="#Q11-Sub-Interval" class="headerlink" title="Q11: Sub Interval"></a>Q11: Sub Interval</h2><p>Using reasoning analogous to Alyssa’s, define a subtraction function for intervals. Try to reuse functions that have already been implemented if you find yourself repeating code.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_interval</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""Return the interval that contains the difference between any value in x and any value in y."""</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    negative_y = interval(-upper_bound(y), -lower_bound(y))</span><br><span class="line">    <span class="keyword">return</span> add_interval(x, negative_y)</span><br></pre></td></tr></table></figure>
<h2 id="Q12-Div-Interval"><a href="#Q12-Div-Interval" class="headerlink" title="Q12: Div Interval"></a>Q12: Div Interval</h2><p>Alyssa implements division below by multiplying by the reciprocal of <code>y</code>. Ben Bitdiddle, an expert systems programmer, looks over Alyssa’s shoulder and comments that it is not clear what it means to divide by an interval that spans zero. Add an <code>assert</code> statement to Alyssa’s code to ensure that no such interval is used as a divisor:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div_interval</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">"""Return the interval that contains the quotient of any value in x divided by</span></span><br><span class="line"><span class="string">    any value in y. Division is implemented as the multiplication of x by the</span></span><br><span class="line"><span class="string">    reciprocal of y."""</span></span><br><span class="line">    <span class="string">"*** YOUR CODE HERE ***"</span></span><br><span class="line">    <span class="keyword">assert</span> lower_bound(y) &gt; <span class="number">0</span> <span class="keyword">or</span> upper_bound(y) &lt; <span class="number">0</span>, <span class="string">'The divisor cannot contain 0'</span></span><br><span class="line">    reciprocal_y = interval(<span class="number">1</span>/upper_bound(y), <span class="number">1</span>/lower_bound(y))</span><br><span class="line">    <span class="keyword">return</span> mul_interval(x, reciprocal_y)</span><br></pre></td></tr></table></figure>
<h2 id="Q13-Par-Diff"><a href="#Q13-Par-Diff" class="headerlink" title="Q13: Par Diff"></a>Q13: Par Diff</h2><p>After considerable work, Alyssa P. Hacker delivers her finished system. Several years later, after she has forgotten all about it, she gets a frenzied call from an irate user, Lem E. Tweakit. It seems that Lem has noticed that the formula for parallel resistors can be written in two algebraically equivalent ways:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">par1(r1, r2) &#x3D; (r1 * r2) &#x2F; (r1 + r2)</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">par2(r1, r2) &#x3D; 1 &#x2F; (1&#x2F;r1 + 1&#x2F;r2)</span><br></pre></td></tr></table></figure>
<p>He has written the following two programs, each of which computes the <code>parallel_resistors</code> formula differently::</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">par1</span><span class="params">(r1, r2)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> div_interval(mul_interval(r1, r2), add_interval(r1, r2))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">par2</span><span class="params">(r1, r2)</span>:</span></span><br><span class="line">    one = interval(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    rep_r1 = div_interval(one, r1)</span><br><span class="line">    rep_r2 = div_interval(one, r2)</span><br><span class="line">    <span class="keyword">return</span> div_interval(one, add_interval(rep_r1, rep_r2))</span><br></pre></td></tr></table></figure>
<p>Lem complains that Alyssa’s program gives different answers for the two ways of computing. This is a serious complaint.</p>
<p>Demonstrate that Lem is right. Investigate the behavior of the system on a variety of arithmetic expressions. Make some intervals <code>r1</code> and <code>r2</code>, and show that <code>par1</code> and <code>par2</code> can give different results.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_par</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Return two intervals that give different results for parallel resistors.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; r1, r2 = check_par()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; x = par1(r1, r2)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; y = par2(r1, r2)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; lower_bound(x) != lower_bound(y) or upper_bound(x) != upper_bound(y)</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    r1 = interval(<span class="number">1</span>, <span class="number">1</span>) <span class="comment"># Replace this line!</span></span><br><span class="line">    r2 = interval(<span class="number">1</span>, <span class="number">1</span>) <span class="comment"># Replace this line!</span></span><br><span class="line">    <span class="keyword">return</span> r1, r2</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_par</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Return two intervals that give different results for parallel resistors.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; r1, r2 = check_par()</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; x = par1(r1, r2)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; y = par2(r1, r2)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; lower_bound(x) != lower_bound(y) or upper_bound(x) != upper_bound(y)</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    r1 = interval(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">    r2 = interval(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> r1, r2</span><br></pre></td></tr></table></figure>
<p>Video walkthrough: <a href="https://youtu.be/H8slb5KCbU4" target="_blank" rel="noopener">https://youtu.be/H8slb5KCbU4</a></p>
<h2 id="Q14-Multiple-References"><a href="#Q14-Multiple-References" class="headerlink" title="Q14: Multiple References"></a>Q14: Multiple References</h2><p>Eva Lu Ator, another user, has also noticed the different intervals computed by different but algebraically equivalent expressions. She says that the problem is multiple references to the same interval.</p>
<p>The Multiple References Problem: a formula to compute with intervals using Alyssa’s system will produce tighter error bounds if it can be written in such a form that no variable that represents an uncertain number is repeated.</p>
<p>Thus, she says, par2 is a better program for parallel resistances than par1. Is she right? Why? Write a function that returns a string containing a written explanation of your answer:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">multiple_references_explanation</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"""The multiple reference problem exists.  The true value</span></span><br><span class="line"><span class="string">    within a particular interval is fixed (though unknown).  Nested</span></span><br><span class="line"><span class="string">    combinations that refer to the same interval twice may assume two different</span></span><br><span class="line"><span class="string">    true values for the same interval, which is an error that results in</span></span><br><span class="line"><span class="string">    intervals that are larger than they should be.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Consider the case of i * i, where i is an interval from -1 to 1.  No value</span></span><br><span class="line"><span class="string">    within this interval, when squared, will give a negative result.  However,</span></span><br><span class="line"><span class="string">    our mul_interval function will allow us to choose 1 from the first</span></span><br><span class="line"><span class="string">    reference to i and -1 from the second, giving an erroneous lower bound of</span></span><br><span class="line"><span class="string">    -1.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Hence, a program like par2 is better than par1 because it never combines</span></span><br><span class="line"><span class="string">    the same interval more than once.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>
<p>Video walkthrough: <a href="https://youtu.be/H8slb5KCbU4" target="_blank" rel="noopener">https://youtu.be/H8slb5KCbU4</a></p>
<h2 id="Q15-Quadratic"><a href="#Q15-Quadratic" class="headerlink" title="Q15: Quadratic"></a>Q15: Quadratic</h2><p>Write a function <code>quadratic</code> that returns the interval of all values f(t) such that t is in the argument interval x and f(t) is a quadratic function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f(t) &#x3D; a*t*t + b*t + c</span><br></pre></td></tr></table></figure>
<p>Make sure that your implementation returns the smallest such interval, one that does not suffer from the multiple references problem.</p>
<p>Hint: the derivative <code>f&#39;(t) = 2*a*t + b</code>, and so the extreme point of the quadratic is <code>-b/(2*a)</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quadratic</span><span class="params">(x, a, b, c)</span>:</span></span><br><span class="line">    <span class="string">"""Return the interval that is the range of the quadratic defined by</span></span><br><span class="line"><span class="string">    coefficients a, b, and c, for domain interval x.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; str_interval(quadratic(interval(0, 2), -2, 3, -1))</span></span><br><span class="line"><span class="string">    '-3 to 0.125'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; str_interval(quadratic(interval(1, 3), 2, -3, 1))</span></span><br><span class="line"><span class="string">    '0 to 10'</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    extremum = -b / (<span class="number">2</span>*a)</span><br><span class="line">    f = <span class="keyword">lambda</span> x: a * x * x + b * x + c</span><br><span class="line">    l, u, e = map(f, (lower_bound(x), upper_bound(x), extremum))</span><br><span class="line">    <span class="keyword">if</span> extremum &gt;= lower_bound(x) <span class="keyword">and</span> extremum &lt;= upper_bound(x):</span><br><span class="line">        <span class="keyword">return</span> interval(min(l, u, e), max(l, u, e))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> interval(min(l, u), max(l, u))</span><br></pre></td></tr></table></figure>
<p>Video walkthrough: <a href="https://youtu.be/qgSn_RNBs4A" target="_blank" rel="noopener">https://youtu.be/qgSn_RNBs4A</a></p>

    </div>

    
    
    
        <div class="reward-container">
  <div>Stick to share, hope you can benefit from these.</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Guohang Ma WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Guohang Ma Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/SICP/" rel="tag"># SICP</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/10/13/cs61c-hw02/" rel="prev" title="cs61c-hw02">
      <i class="fa fa-chevron-left"></i> cs61c-hw02
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/10/19/cs61a-lab06/" rel="next" title="cs61a-lab06">
      cs61a-lab06 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81MDQwMS8yNjg5MQ=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Trees"><span class="nav-number">1.</span> <span class="nav-text">Trees</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q1-Replace-Leaf"><span class="nav-number">1.1.</span> <span class="nav-text">Q1: Replace Leaf</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mobiles"><span class="nav-number">2.</span> <span class="nav-text">Mobiles</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q2-Weights"><span class="nav-number">2.1.</span> <span class="nav-text">Q2: Weights</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q3-Balanced"><span class="nav-number">2.2.</span> <span class="nav-text">Q3: Balanced</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q4-Totals"><span class="nav-number">2.3.</span> <span class="nav-text">Q4: Totals</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mutable-functions"><span class="nav-number">3.</span> <span class="nav-text">Mutable functions</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q5-Counter"><span class="nav-number">3.1.</span> <span class="nav-text">Q5: Counter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q6-Next-Fibonacci"><span class="nav-number">3.2.</span> <span class="nav-text">Q6: Next Fibonacci</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q7-Password-Protected-Account"><span class="nav-number">3.3.</span> <span class="nav-text">Q7: Password Protected Account</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q8-Joint-Account"><span class="nav-number">3.4.</span> <span class="nav-text">Q8: Joint Account</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Generators"><span class="nav-number">4.</span> <span class="nav-text">Generators</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q9-Generate-Paths"><span class="nav-number">4.1.</span> <span class="nav-text">Q9: Generate Paths</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Interval"><span class="nav-number">5.</span> <span class="nav-text">Interval</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Q10-Interval-Abstraction"><span class="nav-number">5.1.</span> <span class="nav-text">Q10: Interval Abstraction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q11-Sub-Interval"><span class="nav-number">5.2.</span> <span class="nav-text">Q11: Sub Interval</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q12-Div-Interval"><span class="nav-number">5.3.</span> <span class="nav-text">Q12: Div Interval</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q13-Par-Diff"><span class="nav-number">5.4.</span> <span class="nav-text">Q13: Par Diff</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q14-Multiple-References"><span class="nav-number">5.5.</span> <span class="nav-text">Q14: Multiple References</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Q15-Quadratic"><span class="nav-number">5.6.</span> <span class="nav-text">Q15: Quadratic</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Guohang Ma"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Guohang Ma</p>
  <div class="site-description" itemprop="description">📚⏰🎶🎸🏊🏽‍♂️🏃🏽‍🍦🍌🍓🌳🗽Love all things...</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">138</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Guohang Ma</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"kmDK0a24LosF4PtvdKclqmTC-gzGzoHsz","app_key":"CpfEBlrDef2N6Oa8psanDLBh","server_url":null,"security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
